Trovate 1 GPU: - /physical_device:GPU:0================= [STEP 1.0] Load and preprocess the datasets =================Training Set Size: 5536Validation Set Size: 1384Test Set Size: 131484Data are preprocessed!================= [STEP 2.0] Generation of pairs =================Classes: 4Total pairs generated: 100000 (P: 50000 - N: 50000)Total duplicate attempts: 472Duplicates over total attempts: 472/100000Classes: 4Total pairs generated: 50000 (P: 25000 - N: 25000)Total duplicate attempts: 1908Duplicates over total attempts: 1908/50000Classes: 4Total pairs generated: 200000 (P: 100000 - N: 100000)Total duplicate attempts: 1Duplicates over total attempts: 1/200000Pairs are generated!================= [STEP 2.1] Check pairs duplicated =================Numero di coppie identiche TRAIN SET: 45/100000Numero di coppie identiche VAL SET: 22/50000Numero di coppie identiche TEST SET: 85/200000================= [STEP 2.2] Reshape pairs in (x, 31, 1,1) =================Pairs are reshaped!================= [STEP 3.0] Training Phase =================Siamese Network Created:Model: "model"__________________________________________________________________________________________________ Layer (type)                Output Shape                 Param #   Connected to================================================================================================== input_1 (InputLayer)        [(None, 31, 1, 1)]           0         [] input_2 (InputLayer)        [(None, 31, 1, 1)]           0         [] sequential (Sequential)     (None, 32)                   453728    ['input_1[0][0]',                                                                     'input_2[0][0]'] lambda (Lambda)             (None, 1)                    0         ['sequential[0][0]',                                                                     'sequential[1][0]']==================================================================================================Total params: 453728 (1.73 MB)Trainable params: 453728 (1.73 MB)Non-trainable params: 0 (0.00 Byte)__________________________________________________________________________________________________Epoch 1/100391/391 [==============================] - ETA: 0s - loss: 0.2792 - accuracy: 0.64102024-12-13 17:56:55.067896: W external/local_tsl/tsl/framework/bfc_allocator.cc:296] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.69GiB with freed_by_count=0. The caller indicates that this is not a failure, but this may mean that there could be performance gains if more memory were available.391/391 [==============================] - 37s 74ms/step - loss: 0.2792 - accuracy: 0.6410 - val_loss: 0.2013 - val_accuracy: 0.7061Epoch 2/100391/391 [==============================] - 24s 60ms/step - loss: 0.1707 - accuracy: 0.7606 - val_loss: 0.1615 - val_accuracy: 0.7703Epoch 3/100391/391 [==============================] - 23s 58ms/step - loss: 0.1426 - accuracy: 0.7978 - val_loss: 0.1421 - val_accuracy: 0.7972Epoch 4/100391/391 [==============================] - 23s 60ms/step - loss: 0.1327 - accuracy: 0.8128 - val_loss: 0.1364 - val_accuracy: 0.8088Epoch 5/100391/391 [==============================] - 24s 60ms/step - loss: 0.1281 - accuracy: 0.8214 - val_loss: 0.1436 - val_accuracy: 0.8076Epoch 6/100391/391 [==============================] - 24s 61ms/step - loss: 0.1244 - accuracy: 0.8280 - val_loss: 0.1313 - val_accuracy: 0.8253Epoch 7/100391/391 [==============================] - 24s 61ms/step - loss: 0.1222 - accuracy: 0.8328 - val_loss: 0.1286 - val_accuracy: 0.8263Epoch 8/100391/391 [==============================] - 24s 61ms/step - loss: 0.1203 - accuracy: 0.8354 - val_loss: 0.1271 - val_accuracy: 0.8310Epoch 9/100391/391 [==============================] - 23s 60ms/step - loss: 0.1184 - accuracy: 0.8382 - val_loss: 0.1263 - val_accuracy: 0.8303Epoch 10/100391/391 [==============================] - 23s 59ms/step - loss: 0.1168 - accuracy: 0.8407 - val_loss: 0.1253 - val_accuracy: 0.8316Epoch 11/100391/391 [==============================] - 23s 59ms/step - loss: 0.1155 - accuracy: 0.8417 - val_loss: 0.1294 - val_accuracy: 0.8234Epoch 12/100391/391 [==============================] - 23s 59ms/step - loss: 0.1140 - accuracy: 0.8437 - val_loss: 0.1232 - val_accuracy: 0.8300Epoch 13/100391/391 [==============================] - 23s 60ms/step - loss: 0.1125 - accuracy: 0.8456 - val_loss: 0.1201 - val_accuracy: 0.8378Epoch 14/100391/391 [==============================] - 23s 60ms/step - loss: 0.1117 - accuracy: 0.8464 - val_loss: 0.1230 - val_accuracy: 0.8312Epoch 15/100391/391 [==============================] - 23s 59ms/step - loss: 0.1103 - accuracy: 0.8480 - val_loss: 0.1207 - val_accuracy: 0.8348Epoch 16/100391/391 [==============================] - 23s 60ms/step - loss: 0.1090 - accuracy: 0.8502 - val_loss: 0.1208 - val_accuracy: 0.8343Epoch 17/100391/391 [==============================] - 23s 60ms/step - loss: 0.1084 - accuracy: 0.8517 - val_loss: 0.1169 - val_accuracy: 0.8393Epoch 18/100391/391 [==============================] - 23s 59ms/step - loss: 0.1073 - accuracy: 0.8531 - val_loss: 0.1164 - val_accuracy: 0.8408Epoch 19/100391/391 [==============================] - 23s 59ms/step - loss: 0.1062 - accuracy: 0.8545 - val_loss: 0.1202 - val_accuracy: 0.8358Epoch 20/100391/391 [==============================] - 23s 59ms/step - loss: 0.1052 - accuracy: 0.8555 - val_loss: 0.1145 - val_accuracy: 0.8402Epoch 21/100391/391 [==============================] - 25s 63ms/step - loss: 0.1050 - accuracy: 0.8564 - val_loss: 0.1143 - val_accuracy: 0.8417Epoch 22/100391/391 [==============================] - 25s 65ms/step - loss: 0.1041 - accuracy: 0.8571 - val_loss: 0.1137 - val_accuracy: 0.8415Epoch 23/100391/391 [==============================] - 26s 66ms/step - loss: 0.1029 - accuracy: 0.8589 - val_loss: 0.1136 - val_accuracy: 0.8405Epoch 24/100391/391 [==============================] - 25s 64ms/step - loss: 0.1023 - accuracy: 0.8598 - val_loss: 0.1155 - val_accuracy: 0.8431Epoch 25/100391/391 [==============================] - 25s 63ms/step - loss: 0.1015 - accuracy: 0.8612 - val_loss: 0.1125 - val_accuracy: 0.8419Epoch 26/100391/391 [==============================] - 24s 61ms/step - loss: 0.1010 - accuracy: 0.8620 - val_loss: 0.1121 - val_accuracy: 0.8416Epoch 27/100391/391 [==============================] - 23s 60ms/step - loss: 0.0995 - accuracy: 0.8631 - val_loss: 0.1110 - val_accuracy: 0.8424Epoch 28/100391/391 [==============================] - 23s 59ms/step - loss: 0.0988 - accuracy: 0.8640 - val_loss: 0.1121 - val_accuracy: 0.8467Epoch 29/100391/391 [==============================] - 23s 59ms/step - loss: 0.0980 - accuracy: 0.8648 - val_loss: 0.1102 - val_accuracy: 0.8424Epoch 30/100391/391 [==============================] - 23s 59ms/step - loss: 0.0976 - accuracy: 0.8665 - val_loss: 0.1084 - val_accuracy: 0.8462Epoch 31/100391/391 [==============================] - 23s 59ms/step - loss: 0.0963 - accuracy: 0.8672 - val_loss: 0.1107 - val_accuracy: 0.8419Epoch 32/100391/391 [==============================] - 23s 60ms/step - loss: 0.0957 - accuracy: 0.8682 - val_loss: 0.1095 - val_accuracy: 0.8434Epoch 33/100391/391 [==============================] - 23s 60ms/step - loss: 0.0952 - accuracy: 0.8692 - val_loss: 0.1093 - val_accuracy: 0.8424Epoch 34/100391/391 [==============================] - 23s 59ms/step - loss: 0.0938 - accuracy: 0.8706 - val_loss: 0.1154 - val_accuracy: 0.8407Epoch 35/100391/391 [==============================] - 24s 61ms/step - loss: 0.0938 - accuracy: 0.8712 - val_loss: 0.1096 - val_accuracy: 0.8432Epoch 36/100391/391 [==============================] - 24s 62ms/step - loss: 0.0935 - accuracy: 0.8715 - val_loss: 0.1069 - val_accuracy: 0.8507Epoch 37/100391/391 [==============================] - 23s 60ms/step - loss: 0.0920 - accuracy: 0.8743 - val_loss: 0.1106 - val_accuracy: 0.8493Epoch 38/100391/391 [==============================] - 23s 60ms/step - loss: 0.0922 - accuracy: 0.8735 - val_loss: 0.1083 - val_accuracy: 0.8482Epoch 39/100391/391 [==============================] - 23s 60ms/step - loss: 0.0909 - accuracy: 0.8761 - val_loss: 0.1047 - val_accuracy: 0.8587Epoch 40/100391/391 [==============================] - 23s 60ms/step - loss: 0.0897 - accuracy: 0.8788 - val_loss: 0.1061 - val_accuracy: 0.8578Epoch 41/100391/391 [==============================] - 23s 59ms/step - loss: 0.0895 - accuracy: 0.8794 - val_loss: 0.1078 - val_accuracy: 0.8515Epoch 42/100391/391 [==============================] - 23s 60ms/step - loss: 0.0897 - accuracy: 0.8798 - val_loss: 0.1079 - val_accuracy: 0.8525Epoch 43/100391/391 [==============================] - 23s 60ms/step - loss: 0.0891 - accuracy: 0.8817 - val_loss: 0.1053 - val_accuracy: 0.8530Epoch 44/100391/391 [==============================] - 23s 59ms/step - loss: 0.0885 - accuracy: 0.8819 - val_loss: 0.1045 - val_accuracy: 0.8615Epoch 45/100391/391 [==============================] - 23s 59ms/step - loss: 0.0876 - accuracy: 0.8840 - val_loss: 0.1030 - val_accuracy: 0.8632Epoch 46/100391/391 [==============================] - 24s 60ms/step - loss: 0.0870 - accuracy: 0.8850 - val_loss: 0.1103 - val_accuracy: 0.8551Epoch 47/100391/391 [==============================] - 23s 60ms/step - loss: 0.0861 - accuracy: 0.8876 - val_loss: 0.1031 - val_accuracy: 0.8572Epoch 48/100391/391 [==============================] - 24s 60ms/step - loss: 0.0855 - accuracy: 0.8883 - val_loss: 0.1006 - val_accuracy: 0.8598Epoch 49/100391/391 [==============================] - 23s 60ms/step - loss: 0.0858 - accuracy: 0.8884 - val_loss: 0.1032 - val_accuracy: 0.8609Epoch 50/100391/391 [==============================] - 23s 60ms/step - loss: 0.0843 - accuracy: 0.8890 - val_loss: 0.1105 - val_accuracy: 0.8480Epoch 51/100391/391 [==============================] - 23s 60ms/step - loss: 0.0845 - accuracy: 0.8899 - val_loss: 0.1116 - val_accuracy: 0.8496Epoch 52/100391/391 [==============================] - 23s 60ms/step - loss: 0.0841 - accuracy: 0.8901 - val_loss: 0.1065 - val_accuracy: 0.8629Epoch 53/100391/391 [==============================] - 23s 60ms/step - loss: 0.0835 - accuracy: 0.8906 - val_loss: 0.1067 - val_accuracy: 0.8533Epoch 54/100391/391 [==============================] - 23s 59ms/step - loss: 0.0833 - accuracy: 0.8918 - val_loss: 0.1036 - val_accuracy: 0.8648Epoch 55/100391/391 [==============================] - 23s 59ms/step - loss: 0.0836 - accuracy: 0.8912 - val_loss: 0.1000 - val_accuracy: 0.8632Epoch 56/100391/391 [==============================] - 23s 59ms/step - loss: 0.0833 - accuracy: 0.8916 - val_loss: 0.0996 - val_accuracy: 0.8641Epoch 57/100391/391 [==============================] - 23s 59ms/step - loss: 0.0815 - accuracy: 0.8940 - val_loss: 0.1016 - val_accuracy: 0.8652Epoch 58/100391/391 [==============================] - 23s 59ms/step - loss: 0.0817 - accuracy: 0.8935 - val_loss: 0.0994 - val_accuracy: 0.8652Epoch 59/100391/391 [==============================] - 23s 59ms/step - loss: 0.0817 - accuracy: 0.8945 - val_loss: 0.1009 - val_accuracy: 0.8627Epoch 60/100391/391 [==============================] - 23s 59ms/step - loss: 0.0811 - accuracy: 0.8950 - val_loss: 0.1086 - val_accuracy: 0.8519Epoch 61/100391/391 [==============================] - 23s 59ms/step - loss: 0.0808 - accuracy: 0.8952 - val_loss: 0.1020 - val_accuracy: 0.8676Epoch 62/100391/391 [==============================] - 23s 60ms/step - loss: 0.0807 - accuracy: 0.8953 - val_loss: 0.0993 - val_accuracy: 0.8651Epoch 63/100391/391 [==============================] - 23s 59ms/step - loss: 0.0798 - accuracy: 0.8967 - val_loss: 0.1013 - val_accuracy: 0.8642Epoch 64/100391/391 [==============================] - 24s 61ms/step - loss: 0.0798 - accuracy: 0.8967 - val_loss: 0.0992 - val_accuracy: 0.8657Epoch 65/100391/391 [==============================] - 23s 60ms/step - loss: 0.0805 - accuracy: 0.8959 - val_loss: 0.1040 - val_accuracy: 0.8639Epoch 66/100391/391 [==============================] - 23s 60ms/step - loss: 0.0800 - accuracy: 0.8967 - val_loss: 0.0976 - val_accuracy: 0.8665Epoch 67/100391/391 [==============================] - 23s 59ms/step - loss: 0.0792 - accuracy: 0.8975 - val_loss: 0.0969 - val_accuracy: 0.8678Epoch 68/100391/391 [==============================] - 23s 59ms/step - loss: 0.0795 - accuracy: 0.8968 - val_loss: 0.1004 - val_accuracy: 0.8702Epoch 69/100391/391 [==============================] - 23s 60ms/step - loss: 0.0794 - accuracy: 0.8982 - val_loss: 0.0982 - val_accuracy: 0.8708Epoch 70/100391/391 [==============================] - 23s 59ms/step - loss: 0.0777 - accuracy: 0.8999 - val_loss: 0.1007 - val_accuracy: 0.8669Epoch 71/100391/391 [==============================] - 23s 59ms/step - loss: 0.0788 - accuracy: 0.8981 - val_loss: 0.1004 - val_accuracy: 0.8639Epoch 72/100391/391 [==============================] - 23s 59ms/step - loss: 0.0778 - accuracy: 0.8995 - val_loss: 0.1028 - val_accuracy: 0.8637Epoch 73/100391/391 [==============================] - 23s 60ms/step - loss: 0.0780 - accuracy: 0.8990 - val_loss: 0.0975 - val_accuracy: 0.8706Epoch 74/100391/391 [==============================] - 24s 61ms/step - loss: 0.0769 - accuracy: 0.9015 - val_loss: 0.0979 - val_accuracy: 0.8707Epoch 75/100391/391 [==============================] - 24s 60ms/step - loss: 0.0771 - accuracy: 0.9008 - val_loss: 0.0990 - val_accuracy: 0.8651Epoch 76/100391/391 [==============================] - 23s 59ms/step - loss: 0.0770 - accuracy: 0.9007 - val_loss: 0.0963 - val_accuracy: 0.8735Epoch 77/100391/391 [==============================] - 23s 59ms/step - loss: 0.0772 - accuracy: 0.9008 - val_loss: 0.0961 - val_accuracy: 0.8724Epoch 78/100391/391 [==============================] - 23s 59ms/step - loss: 0.0768 - accuracy: 0.9016 - val_loss: 0.0963 - val_accuracy: 0.8715Epoch 79/100391/391 [==============================] - 23s 59ms/step - loss: 0.0778 - accuracy: 0.9000 - val_loss: 0.0983 - val_accuracy: 0.8700Epoch 80/100391/391 [==============================] - 23s 60ms/step - loss: 0.0764 - accuracy: 0.9017 - val_loss: 0.0960 - val_accuracy: 0.8698Epoch 81/100391/391 [==============================] - 23s 60ms/step - loss: 0.0754 - accuracy: 0.9033 - val_loss: 0.0968 - val_accuracy: 0.8753Epoch 82/100391/391 [==============================] - 23s 59ms/step - loss: 0.0763 - accuracy: 0.9019 - val_loss: 0.0983 - val_accuracy: 0.8757Epoch 83/100391/391 [==============================] - 23s 59ms/step - loss: 0.0756 - accuracy: 0.9024 - val_loss: 0.0986 - val_accuracy: 0.8702Epoch 84/100391/391 [==============================] - 23s 59ms/step - loss: 0.0759 - accuracy: 0.9029 - val_loss: 0.1015 - val_accuracy: 0.8639Epoch 85/100391/391 [==============================] - 23s 58ms/step - loss: 0.0751 - accuracy: 0.9036 - val_loss: 0.0963 - val_accuracy: 0.8694Epoch 86/100391/391 [==============================] - 23s 58ms/step - loss: 0.0752 - accuracy: 0.9040 - val_loss: 0.0983 - val_accuracy: 0.8729Epoch 87/100391/391 [==============================] - 23s 59ms/step - loss: 0.0746 - accuracy: 0.9037 - val_loss: 0.0988 - val_accuracy: 0.8701Epoch 88/100391/391 [==============================] - 23s 59ms/step - loss: 0.0747 - accuracy: 0.9047 - val_loss: 0.0946 - val_accuracy: 0.8728Epoch 89/100391/391 [==============================] - 23s 59ms/step - loss: 0.0745 - accuracy: 0.9052 - val_loss: 0.0960 - val_accuracy: 0.8746Epoch 90/100391/391 [==============================] - 23s 59ms/step - loss: 0.0745 - accuracy: 0.9050 - val_loss: 0.1071 - val_accuracy: 0.8617Epoch 91/100391/391 [==============================] - 24s 61ms/step - loss: 0.0739 - accuracy: 0.9059 - val_loss: 0.0980 - val_accuracy: 0.8692Epoch 92/100391/391 [==============================] - 24s 61ms/step - loss: 0.0747 - accuracy: 0.9049 - val_loss: 0.0972 - val_accuracy: 0.8722Epoch 93/100391/391 [==============================] - 24s 61ms/step - loss: 0.0733 - accuracy: 0.9065 - val_loss: 0.0982 - val_accuracy: 0.8702Epoch 94/100391/391 [==============================] - 24s 62ms/step - loss: 0.0740 - accuracy: 0.9051 - val_loss: 0.0973 - val_accuracy: 0.8683Epoch 95/100391/391 [==============================] - 24s 61ms/step - loss: 0.0732 - accuracy: 0.9055 - val_loss: 0.0957 - val_accuracy: 0.8717Epoch 96/100391/391 [==============================] - 24s 61ms/step - loss: 0.0741 - accuracy: 0.9053 - val_loss: 0.0959 - val_accuracy: 0.8707Epoch 97/100391/391 [==============================] - 24s 62ms/step - loss: 0.0732 - accuracy: 0.9074 - val_loss: 0.0971 - val_accuracy: 0.8732Epoch 98/100391/391 [==============================] - 24s 62ms/step - loss: 0.0727 - accuracy: 0.9075 - val_loss: 0.0973 - val_accuracy: 0.8722================= [STEP 4.0] Evaluate Model =================6250/6250 [==============================] - 26s 4ms/step - loss: 0.0818 - accuracy: 0.8931Test Loss: 0.0818, Test Accuracy: 0.89316250/6250 [==============================] - 21s 3ms/step              precision    recall  f1-score   support           0       0.88      0.91      0.89    100000           1       0.90      0.88      0.89    100000    accuracy                           0.89    200000   macro avg       0.89      0.89      0.89    200000weighted avg       0.89      0.89      0.89    200000