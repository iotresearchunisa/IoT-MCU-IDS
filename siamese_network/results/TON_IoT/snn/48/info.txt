Trovate 1 GPU: - /physical_device:GPU:0================= [STEP 1.0] Load and preprocess the datasets =================Training Set Size: 66433Validation Set Size: 16609Test Set Size: 55362Data are preprocessed!================= [STEP 2.0] Generation of pairs =================Classes: 4Total pairs generated: 300000 (P: 150000 - N: 150000)Total duplicate attempts: 24Duplicates over total attempts: 24/300000Classes: 4Total pairs generated: 150000 (P: 75000 - N: 75000)Total duplicate attempts: 108Duplicates over total attempts: 108/150000Classes: 4Total pairs generated: 200000 (P: 100000 - N: 100000)Total duplicate attempts: 25Duplicates over total attempts: 25/200000Pairs are generated!================= [STEP 2.1] Check pairs duplicated =================Numero di coppie identiche TRAIN SET: 135/300000Numero di coppie identiche VAL SET: 67/150000Numero di coppie identiche TEST SET: 81/200000================= [STEP 2.2] Reshape pairs in (x, 31, 1,1) =================Pairs are reshaped!================= [STEP 3.0] Training Phase =================Siamese Network Created:Model: "model"__________________________________________________________________________________________________ Layer (type)                Output Shape                 Param #   Connected to================================================================================================== input_1 (InputLayer)        [(None, 31, 1, 1)]           0         [] input_2 (InputLayer)        [(None, 31, 1, 1)]           0         [] sequential (Sequential)     (None, 32)                   453728    ['input_1[0][0]',                                                                     'input_2[0][0]'] lambda (Lambda)             (None, 1)                    0         ['sequential[0][0]',                                                                     'sequential[1][0]']==================================================================================================Total params: 453728 (1.73 MB)Trainable params: 453728 (1.73 MB)Non-trainable params: 0 (0.00 Byte)__________________________________________________________________________________________________Epoch 1/1001172/1172 [==============================] - ETA: 0s - loss: 0.1954 - accuracy: 0.73712024-12-13 18:47:56.095970: W external/local_tsl/tsl/framework/bfc_allocator.cc:296] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.98GiB with freed_by_count=0. The caller indicates that this is not a failure, but this may mean that there could be performance gains if more memory were available.1172/1172 [==============================] - 88s 67ms/step - loss: 0.1954 - accuracy: 0.7371 - val_loss: 0.1398 - val_accuracy: 0.8000Epoch 2/1001172/1172 [==============================] - 71s 60ms/step - loss: 0.1270 - accuracy: 0.8234 - val_loss: 0.1185 - val_accuracy: 0.8382Epoch 3/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.1146 - accuracy: 0.8427 - val_loss: 0.1095 - val_accuracy: 0.8507Epoch 4/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.1092 - accuracy: 0.8488 - val_loss: 0.1055 - val_accuracy: 0.8515Epoch 5/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.1063 - accuracy: 0.8517 - val_loss: 0.1029 - val_accuracy: 0.8563Epoch 6/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.1039 - accuracy: 0.8550 - val_loss: 0.1018 - val_accuracy: 0.8584Epoch 7/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.1020 - accuracy: 0.8576 - val_loss: 0.1004 - val_accuracy: 0.8624Epoch 8/1001172/1172 [==============================] - 72s 62ms/step - loss: 0.0997 - accuracy: 0.8607 - val_loss: 0.0991 - val_accuracy: 0.8656Epoch 9/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0975 - accuracy: 0.8642 - val_loss: 0.0944 - val_accuracy: 0.8782Epoch 10/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0948 - accuracy: 0.8687 - val_loss: 0.0930 - val_accuracy: 0.8716Epoch 11/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0923 - accuracy: 0.8745 - val_loss: 0.0929 - val_accuracy: 0.8832Epoch 12/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0903 - accuracy: 0.8789 - val_loss: 0.0884 - val_accuracy: 0.8853Epoch 13/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.0880 - accuracy: 0.8835 - val_loss: 0.0876 - val_accuracy: 0.8842Epoch 14/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0869 - accuracy: 0.8850 - val_loss: 0.0869 - val_accuracy: 0.8879Epoch 15/1001172/1172 [==============================] - 71s 60ms/step - loss: 0.0856 - accuracy: 0.8868 - val_loss: 0.0843 - val_accuracy: 0.8864Epoch 16/1001172/1172 [==============================] - 72s 62ms/step - loss: 0.0850 - accuracy: 0.8878 - val_loss: 0.0850 - val_accuracy: 0.8829Epoch 17/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0838 - accuracy: 0.8896 - val_loss: 0.0842 - val_accuracy: 0.8869Epoch 18/1001172/1172 [==============================] - 71s 60ms/step - loss: 0.0827 - accuracy: 0.8910 - val_loss: 0.0840 - val_accuracy: 0.8880Epoch 19/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.0823 - accuracy: 0.8913 - val_loss: 0.0839 - val_accuracy: 0.8922Epoch 20/1001172/1172 [==============================] - 71s 61ms/step - loss: 0.0817 - accuracy: 0.8920 - val_loss: 0.0811 - val_accuracy: 0.8968Epoch 21/1001172/1172 [==============================] - 74s 63ms/step - loss: 0.0810 - accuracy: 0.8927 - val_loss: 0.0799 - val_accuracy: 0.8932Epoch 22/1001172/1172 [==============================] - 77s 66ms/step - loss: 0.0804 - accuracy: 0.8932 - val_loss: 0.0813 - val_accuracy: 0.8970Epoch 23/1001172/1172 [==============================] - 78s 67ms/step - loss: 0.0798 - accuracy: 0.8939 - val_loss: 0.0794 - val_accuracy: 0.8961Epoch 24/1001172/1172 [==============================] - 74s 63ms/step - loss: 0.0795 - accuracy: 0.8946 - val_loss: 0.0782 - val_accuracy: 0.8937Epoch 25/1001172/1172 [==============================] - 73s 62ms/step - loss: 0.0788 - accuracy: 0.8952 - val_loss: 0.0787 - val_accuracy: 0.8938Epoch 26/1001172/1172 [==============================] - 75s 64ms/step - loss: 0.0786 - accuracy: 0.8952 - val_loss: 0.0811 - val_accuracy: 0.9007Epoch 27/1001172/1172 [==============================] - 72s 61ms/step - loss: 0.0776 - accuracy: 0.8972 - val_loss: 0.0802 - val_accuracy: 0.8964Epoch 28/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0773 - accuracy: 0.8970 - val_loss: 0.0769 - val_accuracy: 0.8980Epoch 29/1001172/1172 [==============================] - 64s 54ms/step - loss: 0.0773 - accuracy: 0.8975 - val_loss: 0.0828 - val_accuracy: 0.8861Epoch 30/1001172/1172 [==============================] - 61s 52ms/step - loss: 0.0771 - accuracy: 0.8973 - val_loss: 0.0793 - val_accuracy: 0.8891Epoch 31/1001172/1172 [==============================] - 61s 52ms/step - loss: 0.0763 - accuracy: 0.8986 - val_loss: 0.0750 - val_accuracy: 0.9021Epoch 32/1001172/1172 [==============================] - 66s 56ms/step - loss: 0.0761 - accuracy: 0.8989 - val_loss: 0.0765 - val_accuracy: 0.9017Epoch 33/1001172/1172 [==============================] - 65s 56ms/step - loss: 0.0762 - accuracy: 0.8984 - val_loss: 0.0785 - val_accuracy: 0.8955Epoch 34/1001172/1172 [==============================] - 65s 56ms/step - loss: 0.0755 - accuracy: 0.8991 - val_loss: 0.0746 - val_accuracy: 0.8981Epoch 35/1001172/1172 [==============================] - 65s 56ms/step - loss: 0.0755 - accuracy: 0.8996 - val_loss: 0.0750 - val_accuracy: 0.9013Epoch 36/1001172/1172 [==============================] - 65s 56ms/step - loss: 0.0748 - accuracy: 0.8997 - val_loss: 0.0756 - val_accuracy: 0.8963Epoch 37/1001172/1172 [==============================] - 65s 55ms/step - loss: 0.0750 - accuracy: 0.9001 - val_loss: 0.0749 - val_accuracy: 0.9016Epoch 38/1001172/1172 [==============================] - 64s 55ms/step - loss: 0.0746 - accuracy: 0.9000 - val_loss: 0.0780 - val_accuracy: 0.8929Epoch 39/1001172/1172 [==============================] - 65s 55ms/step - loss: 0.0742 - accuracy: 0.9009 - val_loss: 0.0748 - val_accuracy: 0.9012Epoch 40/1001172/1172 [==============================] - 64s 54ms/step - loss: 0.0739 - accuracy: 0.9012 - val_loss: 0.0741 - val_accuracy: 0.8994Epoch 41/1001172/1172 [==============================] - 64s 55ms/step - loss: 0.0741 - accuracy: 0.9007 - val_loss: 0.0772 - val_accuracy: 0.8996Epoch 42/1001172/1172 [==============================] - 62s 53ms/step - loss: 0.0737 - accuracy: 0.9014 - val_loss: 0.0731 - val_accuracy: 0.9009Epoch 43/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0734 - accuracy: 0.9014 - val_loss: 0.0723 - val_accuracy: 0.9037Epoch 44/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0732 - accuracy: 0.9019 - val_loss: 0.0726 - val_accuracy: 0.8981Epoch 45/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0727 - accuracy: 0.9025 - val_loss: 0.0713 - val_accuracy: 0.9041Epoch 46/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0728 - accuracy: 0.9025 - val_loss: 0.0728 - val_accuracy: 0.8999Epoch 47/1001172/1172 [==============================] - 68s 58ms/step - loss: 0.0728 - accuracy: 0.9025 - val_loss: 0.0735 - val_accuracy: 0.9028Epoch 48/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0722 - accuracy: 0.9030 - val_loss: 0.0740 - val_accuracy: 0.8994Epoch 49/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0718 - accuracy: 0.9041 - val_loss: 0.0734 - val_accuracy: 0.8983Epoch 50/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0716 - accuracy: 0.9047 - val_loss: 0.0784 - val_accuracy: 0.8920Epoch 51/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0718 - accuracy: 0.9038 - val_loss: 0.0770 - val_accuracy: 0.8952Epoch 52/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0710 - accuracy: 0.9045 - val_loss: 0.0710 - val_accuracy: 0.9032Epoch 53/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0712 - accuracy: 0.9043 - val_loss: 0.0714 - val_accuracy: 0.9032Epoch 54/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0711 - accuracy: 0.9044 - val_loss: 0.0732 - val_accuracy: 0.9024Epoch 55/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0705 - accuracy: 0.9053 - val_loss: 0.0711 - val_accuracy: 0.9033Epoch 56/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0701 - accuracy: 0.9057 - val_loss: 0.0699 - val_accuracy: 0.9083Epoch 57/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0701 - accuracy: 0.9054 - val_loss: 0.0702 - val_accuracy: 0.9052Epoch 58/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0700 - accuracy: 0.9057 - val_loss: 0.0708 - val_accuracy: 0.9042Epoch 59/1001172/1172 [==============================] - 86s 73ms/step - loss: 0.0697 - accuracy: 0.9062 - val_loss: 0.0692 - val_accuracy: 0.9075Epoch 60/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0696 - accuracy: 0.9060 - val_loss: 0.0685 - val_accuracy: 0.9104Epoch 61/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0691 - accuracy: 0.9070 - val_loss: 0.0703 - val_accuracy: 0.9063Epoch 62/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0690 - accuracy: 0.9072 - val_loss: 0.0717 - val_accuracy: 0.9043Epoch 63/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0690 - accuracy: 0.9069 - val_loss: 0.0687 - val_accuracy: 0.9074Epoch 64/1001172/1172 [==============================] - 85s 73ms/step - loss: 0.0685 - accuracy: 0.9077 - val_loss: 0.0696 - val_accuracy: 0.9056Epoch 65/1001172/1172 [==============================] - 75s 64ms/step - loss: 0.0685 - accuracy: 0.9075 - val_loss: 0.0689 - val_accuracy: 0.9079Epoch 66/1001172/1172 [==============================] - 58s 49ms/step - loss: 0.0683 - accuracy: 0.9081 - val_loss: 0.0679 - val_accuracy: 0.9103Epoch 67/1001172/1172 [==============================] - 82s 70ms/step - loss: 0.0682 - accuracy: 0.9077 - val_loss: 0.0685 - val_accuracy: 0.9096Epoch 68/1001172/1172 [==============================] - 68s 58ms/step - loss: 0.0678 - accuracy: 0.9088 - val_loss: 0.0672 - val_accuracy: 0.9107Epoch 69/1001172/1172 [==============================] - 58s 49ms/step - loss: 0.0679 - accuracy: 0.9082 - val_loss: 0.0693 - val_accuracy: 0.9078Epoch 70/1001172/1172 [==============================] - 58s 50ms/step - loss: 0.0678 - accuracy: 0.9084 - val_loss: 0.0720 - val_accuracy: 0.9010Epoch 71/1001172/1172 [==============================] - 59s 50ms/step - loss: 0.0678 - accuracy: 0.9085 - val_loss: 0.0674 - val_accuracy: 0.9080Epoch 72/1001172/1172 [==============================] - 59s 50ms/step - loss: 0.0671 - accuracy: 0.9095 - val_loss: 0.0665 - val_accuracy: 0.9106Epoch 73/1001172/1172 [==============================] - 59s 50ms/step - loss: 0.0675 - accuracy: 0.9089 - val_loss: 0.0668 - val_accuracy: 0.9090Epoch 74/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0669 - accuracy: 0.9095 - val_loss: 0.0688 - val_accuracy: 0.9076Epoch 75/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0670 - accuracy: 0.9094 - val_loss: 0.0668 - val_accuracy: 0.9085Epoch 76/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0671 - accuracy: 0.9094 - val_loss: 0.0681 - val_accuracy: 0.9086Epoch 77/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0666 - accuracy: 0.9099 - val_loss: 0.0694 - val_accuracy: 0.9041Epoch 78/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0667 - accuracy: 0.9100 - val_loss: 0.0656 - val_accuracy: 0.9119Epoch 79/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0666 - accuracy: 0.9098 - val_loss: 0.0702 - val_accuracy: 0.9046Epoch 80/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0667 - accuracy: 0.9099 - val_loss: 0.0654 - val_accuracy: 0.9125Epoch 81/1001172/1172 [==============================] - 59s 51ms/step - loss: 0.0665 - accuracy: 0.9102 - val_loss: 0.0695 - val_accuracy: 0.9050Epoch 82/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0662 - accuracy: 0.9103 - val_loss: 0.0672 - val_accuracy: 0.9101Epoch 83/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0660 - accuracy: 0.9104 - val_loss: 0.0666 - val_accuracy: 0.9096Epoch 84/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0659 - accuracy: 0.9109 - val_loss: 0.0658 - val_accuracy: 0.9081Epoch 85/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0660 - accuracy: 0.9107 - val_loss: 0.0671 - val_accuracy: 0.9106Epoch 86/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0658 - accuracy: 0.9110 - val_loss: 0.0658 - val_accuracy: 0.9121Epoch 87/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0657 - accuracy: 0.9111 - val_loss: 0.0656 - val_accuracy: 0.9097Epoch 88/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0657 - accuracy: 0.9109 - val_loss: 0.0645 - val_accuracy: 0.9121Epoch 89/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0654 - accuracy: 0.9113 - val_loss: 0.0659 - val_accuracy: 0.9085Epoch 90/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0653 - accuracy: 0.9113 - val_loss: 0.0655 - val_accuracy: 0.9116Epoch 91/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0654 - accuracy: 0.9111 - val_loss: 0.0667 - val_accuracy: 0.9091Epoch 92/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0650 - accuracy: 0.9116 - val_loss: 0.0659 - val_accuracy: 0.9098Epoch 93/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0650 - accuracy: 0.9118 - val_loss: 0.0680 - val_accuracy: 0.9077Epoch 94/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0651 - accuracy: 0.9118 - val_loss: 0.0665 - val_accuracy: 0.9092Epoch 95/1001172/1172 [==============================] - 60s 51ms/step - loss: 0.0647 - accuracy: 0.9121 - val_loss: 0.0662 - val_accuracy: 0.9087Epoch 96/1001172/1172 [==============================] - 64s 55ms/step - loss: 0.0648 - accuracy: 0.9122 - val_loss: 0.0649 - val_accuracy: 0.9115Epoch 97/1001172/1172 [==============================] - 87s 74ms/step - loss: 0.0646 - accuracy: 0.9123 - val_loss: 0.0647 - val_accuracy: 0.9092Epoch 98/1001172/1172 [==============================] - 69s 59ms/step - loss: 0.0649 - accuracy: 0.9120 - val_loss: 0.0665 - val_accuracy: 0.9108================= [STEP 4.0] Evaluate Model =================6250/6250 [==============================] - 23s 4ms/step - loss: 0.0666 - accuracy: 0.9088Test Loss: 0.0666, Test Accuracy: 0.90886250/6250 [==============================] - 17s 3ms/step              precision    recall  f1-score   support           0       0.88      0.94      0.91    100000           1       0.94      0.88      0.91    100000    accuracy                           0.91    200000   macro avg       0.91      0.91      0.91    200000weighted avg       0.91      0.91      0.91    200000